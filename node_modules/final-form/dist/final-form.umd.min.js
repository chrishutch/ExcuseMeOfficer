!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e["final-form"]={})}(this,function(e){"use strict";var t=function(e){if(null===e||void 0===e||!e.length)return[];if("string"!=typeof e)throw new Error("toPath() expects a string");return e.split(/[.[\]]+/).filter(Boolean)},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},n=function(e,r){for(var n=t(r),a=e,o=0;o<n.length;o++){var u=n[o];if(void 0===a||null===a||"object"!==(void 0===a?"undefined":i(a))||Array.isArray(a)&&isNaN(u))return;a=a[u]}return a},a=function(e,i,n){if(void 0===e||null===e)throw new Error("Cannot call setIn() with "+String(e)+" state");if(void 0===i||null===i)throw new Error("Cannot call setIn() with "+String(i)+" key");return function e(t,i,n,a){if(i>=n.length)return a;var o=n[i];if(isNaN(o)){var u;if(void 0===t||null===t){var s,l=e(void 0,i+1,n,a);return void 0===l?void 0:((s={})[o]=l,s)}if(Array.isArray(t))throw new Error("Cannot set a non-numeric property on an array");var c=e(t[o],i+1,n,a),f=Object.keys(t).length;if(void 0===c){if(void 0===t[o]&&0===f)return;if(void 0!==t[o]&&f<=1)return isNaN(n[i-1])?void 0:{}}return r({},t,((u={})[o]=c,u))}var d=Number(o);if(void 0===t||null===t){var v=e(void 0,i+1,n,a);if(void 0===v)return;var b=[];return b[d]=v,b}if(!Array.isArray(t))throw new Error("Cannot set a numeric property on an object");var m=e(t[d],i+1,n,a),h=[].concat(t);return h[d]=m,h}(e,0,t(i),n)},o="FINAL_FORM/form-error",u="FINAL_FORM/array-error",s=function(e,t){var i=e.errors,r=e.initialValues,a=e.lastSubmittedValues,o=e.submitErrors,s=e.submitFailed,l=e.submitSucceeded,c=e.values,f=t.active,d=t.blur,v=t.change,b=t.data,m=t.focus,h=t.name,S=t.touched,y=t.visited,g=n(c,h),p=n(i,h);p&&p[u]&&(p=p[u]);var E=o&&n(o,h),O=r&&n(r,h),F=t.isEqual(O,g),j=!(!a||t.isEqual(n(a,h),g)),k=!p&&!E;return{active:f,blur:d,change:v,data:b,dirty:!F,dirtySinceLastSubmit:j,error:p,focus:m,initial:O,invalid:!k,length:Array.isArray(g)?g.length:void 0,name:h,pristine:F,submitError:E,submitFailed:s,submitSucceeded:l,touched:S,valid:k,value:g,visited:y}},l=["active","data","dirty","dirtySinceLastSubmit","error","initial","invalid","length","pristine","submitError","submitFailed","submitSucceeded","touched","valid","value","visited"],c=function(e,t){if(e===t)return!0;if("object"!==(void 0===e?"undefined":i(e))||!e||"object"!==(void 0===t?"undefined":i(t))||!t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(t),o=0;o<r.length;o++){var u=r[o];if(!a(u)||e[u]!==t[u])return!1}return!0};function f(e,t,i,r,n,a){var o=!1;return n.forEach(function(n){r[n]&&(e[n]=t[n],i&&(~a.indexOf(n)?c(t[n],i[n]):t[n]===i[n])||(o=!0))}),o}var d=["data"],v=function(e,t,i,r){var n={blur:e.blur,change:e.change,focus:e.focus,name:e.name};return f(n,e,t,i,l,d)||!t||r?n:void 0},b=["active","dirty","dirtySinceLastSubmit","error","errors","hasSubmitErrors","hasValidationErrors","initialValues","invalid","pristine","submitting","submitError","submitErrors","submitFailed","submitSucceeded","touched","valid","validating","values","visited"],m=["touched","visited"],h=function(e,t,i,r){var n={};return f(n,e,t,i,b,m)||!t||r?n:void 0},S=function(e){var t=void 0,i=void 0;return function(){for(var r=arguments.length,n=Array(r),a=0;a<r;a++)n[a]=arguments[a];return t&&n.length===t.length&&!n.some(function(e,i){return!c(t[i],e)})||(t=n,i=e.apply(void 0,n)),i}},y=function(e){return!!e&&("object"===(void 0===e?"undefined":i(e))||"function"==typeof e)&&"function"==typeof e.then},g=function(e,t){return e===t},p=function(e){var t=e.active,i=e.dirtySinceLastSubmit,r=e.error,n=e.errors,a=e.initialValues,o=e.pristine,u=e.submitting,s=e.submitFailed,l=e.submitSucceeded,c=e.submitError,f=e.submitErrors,d=e.valid,v=e.validating,b=e.values;return{active:t,dirty:!o,dirtySinceLastSubmit:i,error:r,errors:n,hasSubmitErrors:!!(c||f&&Object.keys(f).length),hasValidationErrors:!(!r&&!Object.keys(n).length),invalid:!d,initialValues:a,pristine:o,submitting:u,submitFailed:s,submitSucceeded:l,submitError:c,submitErrors:f,valid:d,validating:v>0,values:b}};function E(e,t,i,r,n){var a=n(i,r,t,arguments.length>5&&void 0!==arguments[5]&&arguments[5]);a&&e(a)}function O(e,t,i,r){var n=e.entries;Object.keys(n).forEach(function(e){var a=n[Number(e)],o=a.subscription;E(a.subscriber,o,t,i,r)})}e.createForm=function(e){if(!e)throw new Error("No config specified");e.debug;var t=e.initialValues,i=e.mutators,l=e.onSubmit,f=e.validate,d=e.validateOnBlur;if(!l)throw new Error("No onSubmit function specified");var b={subscribers:{index:0,entries:{}},fieldSubscribers:{},fields:{},formState:{dirtySinceLastSubmit:!1,errors:{},initialValues:t&&r({},t),invalid:!1,pristine:!0,submitting:!1,submitFailed:!1,submitSucceeded:!1,valid:!0,validating:0,values:t?r({},t):{}},lastFormState:void 0},m=!1,F=!1,j=!1,k=0,w={},V=function(e){return function(t){return delete w[e],t}},N=function(e,t,i){if(e.fields[t]){var r=i(n(e.formState.values,t));e.formState.values=a(e.formState.values,t,r)||{}}},A=function(e){return function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];if(i){var u={formState:b.formState,fields:b.fields},s=i[e](r,u,{changeValue:N,getIn:n,setIn:a,shallowEqual:c});return b.formState=u.formState,b.fields=u.fields,x(void 0,function(){L(),M()}),s}}},R=i&&Object.keys(i).reduce(function(e,t){return e[t]=A(t),e},{})||{},I=function(e){return Object.keys(e.validators).reduce(function(t,i){var r=e.validators[Number(i)]();return r&&t.push(r),t},[])},x=function(e,t){if(F)return j=!0,void(t&&t());var i=b.fields,s=b.formState,l=Object.keys(i);if(f||l.some(function(e){return I(i[e]).length})){var d=!1;if(e){var v=i[e].validateFields;v&&(d=!0,l=v.length?v.concat(e):[e])}var m={},h={},S=[].concat(function(e){var t=[];if(f){var i=f(r({},b.formState.values));if(y(i)){var n=k++,a=i.then(e).then(V(n));t.push(a),w[n]=a}else e(i)}return t}(function(e){m=e||{}}),l.reduce(function(e,t){return e.concat(function(e,t){var i=[],r=I(e);if(r.length){var a=void 0;r.forEach(function(r){var o=r(n(b.formState.values,e.name),b.formState.values);if(o&&y(o)){var u=k++,s=o.then(t).then(V(u));i.push(s),w[u]=s}else a||(a=o)}),t(a)}return i}(i[t],function(e){h[t]=e}))},[])),g=function(){var e=r({},d?s.errors:{},m),t=function(t){l.forEach(function(r){if(i[r]){var a=n(m,r),o=n(e,r),u=I(i[r]).length,s=h[r];t(r,u&&s||f&&a||(a||d?void 0:o))}})};t(function(t,i){e=a(e,t,i)||{}}),t(function(t,i){if(i&&i[u]){var r=n(e,t),o=[].concat(r);o[u]=i[u],e=a(e,t,o)}}),c(s.errors,e)||(s.errors=e),s.error=m[o]};g(),S.length?(b.formState.validating++,t&&t(),Promise.all(S).then(function(){b.formState.validating--,g(),t&&t()})):t&&t()}else t&&t()},L=function(e){if(!m&&!F){var t=b.fields,i=b.fieldSubscribers,r=b.formState;Object.keys(t).forEach(function(e){var n=t[e],a=s(r,n),o=n.lastFieldState;c(a,o)||(n.lastFieldState=a,O(i[e],a,o,v))})}},P=function(){Object.keys(b.fields).forEach(function(e){b.fields[e].touched=!0})},q=function(){var e=b.fields,t=b.formState,i=b.lastFormState,r=Object.keys(e);t.pristine=r.every(function(i){return e[i].isEqual(n(t.values,i),n(t.initialValues||{},i))}),t.dirtySinceLastSubmit=!(!t.lastSubmittedValues||r.every(function(i){return e[i].isEqual(n(t.values,i),n(t.lastSubmittedValues||{},i))})),t.valid=!(t.error||t.submitError||Object.keys(t.errors).length||t.submitErrors&&Object.keys(t.submitErrors).length);var a=p(t),o=r.reduce(function(t,i){return t.touched[i]=e[i].touched,t.visited[i]=e[i].visited,t},{touched:{},visited:{}}),u=o.touched,s=o.visited;return a.touched=i&&c(i.touched,u)?i.touched:u,a.visited=i&&c(i.visited,s)?i.visited:s,i&&c(i,a)?i:a},_=!1,C=!1,M=function e(){if(_)C=!0;else{if(_=!0,!m&&!F){var t=b.lastFormState,i=q();i!==t&&(b.lastFormState=i,O(b.subscribers,i,t,h))}_=!1,C&&(C=!1,e())}};x();var z={batch:function(e){m=!0,e(),m=!1,L(),M()},blur:function(e){var t=b.fields,i=b.formState,n=t[e];n&&(delete i.active,t[e]=r({},n,{active:!1,touched:!0}),d?x(e,function(){L(),M()}):(L(),M()))},change:function(e,t){var i=b.fields,r=b.formState;i[e]&&n(r.values,e)!==t&&(N(b,e,function(){return t}),d?(L(),M()):x(e,function(){L(),M()}))},focus:function(e){var t=b.fields[e];t&&!t.active&&(b.formState.active=e,t.active=!0,t.visited=!0,L(),M())},mutators:R,getFieldState:function(e){var t=b.fields[e];return t&&t.lastFieldState},getRegisteredFields:function(){return Object.keys(b.fields)},getState:function(){return p(b.formState)},initialize:function(e){var t=b.fields,i=b.formState;i.initialValues=e,i.values=e,Object.keys(t).forEach(function(e){var i=t[e];i.touched=!1,i.visited=!1}),x(void 0,function(){L(),M()})},isValidationPaused:function(){return F},pauseValidation:function(){F=!0},registerField:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments[3];b.fieldSubscribers[e]||(b.fieldSubscribers[e]={index:0,entries:{}});var o=b.fieldSubscribers[e].index++;if(b.fieldSubscribers[e].entries[o]={subscriber:S(t),subscription:i},!b.fields[e]){var u=b.formState.initialValues?n(b.formState.initialValues,e):void 0;b.fields[e]={active:!1,blur:function(){return z.blur(e)},change:function(t){return z.change(e,t)},data:{},focus:function(){return z.focus(e)},initial:u,isEqual:r&&r.isEqual||g,lastFieldState:void 0,name:e,touched:!1,valid:!0,validateFields:r&&r.validateFields,validators:{},visited:!1}}r&&r.getValidator&&(b.fields[e].validators[o]=r.getValidator);var l=!1;return x(void 0,function(){var r;M(),l||(r=s(b.formState,b.fields[e]),E(t,i,r,void 0,v,!0),b.fields[e].lastFieldState=r,l=!0),L()}),function(){delete b.fields[e].validators[o],delete b.fieldSubscribers[e].entries[o],Object.keys(b.fieldSubscribers[e].entries).length||(delete b.fieldSubscribers[e],delete b.fields[e],b.formState.errors=a(b.formState.errors,e,void 0)||{}),x(void 0,function(){L(),M()})}},reset:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b.formState.initialValues;b.formState.submitFailed=!1,b.formState.submitSucceeded=!1,delete b.formState.submitErrors,delete b.formState.lastSubmittedValues,z.initialize(e||{})},resumeValidation:function(){F=!1,j&&x(void 0,function(){L(),M()}),j=!1},setConfig:function(e,t){switch(e){case"debug":break;case"initialValues":z.initialize(t);break;case"mutators":i=t,t?(Object.keys(R).forEach(function(e){e in t||delete R[e]}),Object.keys(t).forEach(function(e){R[e]=A(e)})):Object.keys(R).forEach(function(e){delete R[e]});break;case"onSubmit":l=t;break;case"validate":f=t,x(void 0,function(){L(),M()});break;case"validateOnBlur":d=t;break;default:throw new Error("Unrecognised option "+e)}},submit:function(){var e=b.formState;if(b.formState.error||Object.keys(b.formState.errors).length)return P(),b.formState.submitFailed=!0,M(),void L();var t=Object.keys(w);if(t.length)Promise.all(t.reduce(function(e,t){return e.push(w[Number(t)]),e},[])).then(function(){return z.submit()});else{var i=void 0,n=!1,a=function(t){return e.submitting=!1,t&&Object.keys(t).length?(e.submitFailed=!0,e.submitSucceeded=!1,e.submitErrors=t,e.submitError=t[o],P()):(delete e.submitErrors,delete e.submitError,e.submitFailed=!1,e.submitSucceeded=!0),M(),L(),n=!0,i&&i(t),t};if(e.submitting=!0,e.submitFailed=!1,e.submitSucceeded=!1,e.lastSubmittedValues=r({},e.values),3===l.length){if(l(e.values,z,a),!n)return M(),new Promise(function(e){i=e})}else{var u=l(e.values,z);if(u&&y(u))return M(),u.then(a);a(u)}}},subscribe:function(e,t){if(!e)throw new Error("No callback given.");if(!t)throw new Error("No subscription provided. What values do you want to listen to?");var i=S(e),r=b.subscribers,n=b.lastFormState,a=r.index++;r.entries[a]={subscriber:i,subscription:t};var o=q();return o!==n&&(b.lastFormState=o),E(i,t,o,o,h,!0),function(){delete r.entries[a]}}};return z},e.version="4.6.1",e.ARRAY_ERROR=u,e.FORM_ERROR=o,e.formSubscriptionItems=b,e.fieldSubscriptionItems=l,e.getIn=n,e.setIn=a,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=final-form.umd.min.js.map
